# Invoate Console Commands

[![Latest Version on Packagist](https://img.shields.io/packagist/v/invoate/console-commands.svg?style=flat-square)](https://packagist.org/packages/invoate/console-commands)
[![GitHub Tests Action Status](https://img.shields.io/github/actions/workflow/status/invoate/console-commands/run-tests.yml?branch=main&label=tests&style=flat-square)](https://github.com/invoate/console-commands/actions?query=workflow%3Arun-tests+branch%3Amain)
[![GitHub Code Style Action Status](https://img.shields.io/github/actions/workflow/status/invoate/console-commands/fix-php-code-style-issues.yml?branch=main&label=code%20style&style=flat-square)](https://github.com/invoate/console-commands/actions?query=workflow%3A"Fix+PHP+code+style+issues"+branch%3Amain)
[![Total Downloads](https://img.shields.io/packagist/dt/invoate/console-commands.svg?style=flat-square)](https://packagist.org/packages/invoate/console-commands)

These are a few console commands packaged together so they don't have to be recreated in new projects.

## Installation

You can install the package via composer:

```shell
composer require invoate/console-commands
```

## Usage

### Pivot Make Command

The Pivot Make Command generates a migration for a pivot table. Table names can be passed in any order, the command will alphabetise them.

```shell
php artisan make:pivot table1 table2
```

The `table1` and `table2` arguments can be existing Eloquent models or table names. Table names for Eloquent models will be automatically resolved.

```shell
php artisan make:pivot User Team
```
```php
Schema::create('teams_users', function (Blueprint $table) {
    $table->foreignId('team_id')->constrained();
    $table->foreignId('user_id')->constrained();
    //..
});
```

By default the command generates foreign keys, this can be disabled with the `--without-foreign-keys` flag.

```shell
php artisan make:pivot User Team --without-foreign-keys
```
```php
Schema::create('teams_users', function (Blueprint $table) {
    $table->integer('team_id');
    $table->integer('user_id');
    //..
});
```

Timestamp columns are also generated by default, the `--without-timestamps` flag will disable these.

```shell
php artisan make:pivot User Team --without-timestamps
```

Additional columns can be created using the `--columns` flag, they must be formatted in the `column_name:column_type` format.

```shell
php artisan make:pivot User Team --columns string:role,timestamp:expires_at
```
```php
Schema::create('teams_users', function (Blueprint $table) {
    //..
    $table->string('role');
    $table->timestamp('expires_at');
    //..
});
```

A pivot Eloquent model can be generated with the `--with-model` flag.

```shell
php artisan make:pivot User Team --model

# INFO  Migration [database/migrations/2023_02_20_153354_create_teams_users_table.php] created successfully.
# INFO  Model [app/Models/TeamUser.php] created successfully.
```

Optionaly an id column can be generated using the `--with-id` flag. By default this will generate a `$table->id()` column, passing another Laravel supported column type with e.g. `--id-type ulid` will change this.

```shell
php artisan make:pivot User Team --with-id --id-type ulid
```
```php
Schema::create('teams_users', function (Blueprint $table) {
    $table->ulid();
    //..
});
```

If you do not wish to generate any columns for the pivot table you can use the `--without-columns` flag.

```shell
php artisan make:pivot User Team --without-columns
```
```php
Schema::create('teams_users', function (Blueprint $table) {
    //
});
```

### Refresh

The `RefreshCommand` is a simple wrapper for `php artisan migrate:fresh --seed`.

```shell
php artisan refresh
```

## Testing

```shell
composer test
```

## Credits

- [Oliver Lumby](https://github.com/olumby)
- [All Contributors](../../contributors)

## License

The MIT License (MIT). Please see [License File](LICENSE.md) for more information.
